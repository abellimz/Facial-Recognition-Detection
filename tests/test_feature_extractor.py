import unittest

from face_features.facenet import FaceNet
from face_features.mobilenet import MobileNet


class MLPKerasTest(unittest.TestCase):
    def test_mobilenet(self):
        image_paths = ["./data/test_check_in.jpg"]
        mobile_net= MobileNet()
        actual = mobile_net.extract_features(image_paths)
        self.assertEqual(len(actual[0]), 1024)
        self.assertTrue(any(v != 0 for v in actual[0]))

    def test_facenet(self):
        image_paths = ["./data/test_check_in.jpg"]
        face_net= FaceNet()
        expected = [[-0.011617624200880527, -0.11569633334875107, -0.057972028851509094, -0.12494483590126038, 0.046052489429712296, 0.0033455719240009785, -0.026678599417209625, 0.008706837892532349, 0.03487483784556389, -0.013691356405615807, 0.15088513493537903, -0.04210982099175453, -0.009443399496376514, -0.18817190825939178, -0.037431132048368454, -0.00019098514167126268, 0.058966897428035736, -0.061436787247657776, 0.09282812476158142, -0.1352863758802414, -0.06465072184801102, -0.002665699692443013, -0.11445631831884384, 0.05712290480732918, 0.025096233934164047, 0.0014737516175955534, 0.15399910509586334, 0.10612677782773972, -0.10894065350294113, -0.0241374671459198, -0.09213463962078094, 0.09007444977760315, -0.04986797645688057, -0.059788577258586884, 0.04991256818175316, 0.03574046120047569, 0.06019006296992302, 0.07532116025686264, 0.14429055154323578, 0.034187693148851395, 0.05680546909570694, 0.011475332081317902, 0.04188533127307892, -0.06208813562989235, -0.13800497353076935, -0.11833397299051285, 0.05180620402097702, -0.10628210753202438, 0.04285507649183273, 0.029225610196590424, -0.06361480057239532, 0.11674868315458298, 0.14675801992416382, -0.12346118688583374, 0.0006173731526359916, 0.17433060705661774, -0.008591283112764359, -0.015322648920118809, -0.013378460891544819, -0.1446530818939209, -0.06526428461074829, -0.06824452430009842, -0.010415975004434586, 0.11218544840812683, 0.07133800536394119, 0.1444326937198639, 0.04783114418387413, 0.058867666870355606, -0.053059883415699005, -0.05606919527053833, 0.04722651094198227, -0.11761929094791412, 0.08113984018564224, -0.18442021310329437, 0.039539139717817307, 0.02524193562567234, -0.07566151767969131, 0.1392621248960495, -0.16059112548828125, -0.0799529030919075, -0.0690608099102974, -0.057927537709474564, -0.049518879503011703, 0.10192316770553589, 0.07665063440799713, 0.03796198591589928, 0.06454955041408539, -0.015829872339963913, -0.10113246738910675, 0.1456642895936966, 0.11052749305963516, -0.06366845965385437, -0.046933338046073914, -0.02810686267912388, 0.10638737678527832, 0.06227048113942146, -0.04336187243461609, -0.15271954238414764, -0.11061985045671463, 0.05467408522963524, -0.011916123330593109, 0.10913940519094467, 0.1833743304014206, -0.17770513892173767, -0.023951075971126556, 0.018674951046705246, -0.0026613532099872828, 0.006707859691232443, -0.018443701788783073, -0.1251615434885025, 0.13985541462898254, 0.032406821846961975, 0.08093401044607162, 0.11912926286458969, 0.04508574679493904, 0.025514861568808556, -0.08853129297494888, 0.1871126890182495, 0.10839145630598068, 0.11616860330104828, -0.09427961707115173, -0.0857623964548111, 0.09150635451078415, 0.07626431435346603, 0.05437568202614784, -0.07992114126682281, 0.1219714805483818, 0.028462955728173256]]
        actual = face_net.extract_features(image_paths)
        self.assertEqual(expected, actual)

if __name__ == '__main__':
    unittest.main()
